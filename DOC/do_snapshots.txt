###############################################################################
        GEUO SUITE: Scripts for Automating Molecular Modelling Tasks
###############################################################################
  
  SCRIPT's NAME:  do_snapshots.sh             

  GOAL: 

  Extract a series of equally spaced snapshots from MD trajectories.
  The script is desgined to extract both solute + water/counterions
  coordinates, preferably from the "peeled" md_*_solutewat.mdcrd files 
  generated by do_runmd.sh. It characterizes also the
  distribution of the Na+ ions around the solute atoms since this information
  can be particularly relevant for aptamer systems.
  If requested do_snapshots.sh can process trajectory files containing
  only solute atoms.
 
  USAGE : do_snapshots.sh  "MOL1 MOL2 ..."   MD_TYPE

  where MOL1, MOL2 (enclosed in quotation marks) are the project alias of
  the MD trajectories of interest. MD_TYPE can be either "MD" or "GAMD". 
 
          do_snapshots.sh  input.src       
 
  If the input filename has src extension then do_snapshots.sh sources its 
  the line in the src file that should contain variable declarations for 
  the various options indicated below.

  This script must be called from the main directory where the MD/GAMD 
  directories are located.  
  See $GEUO/DOC/directory_tree.txt for details.

  OPTIONS: (selected by environment variables) 

    MOL='alias'        # Project alias. Several aliases can be grouped
                       # into a single varaible MD_TRAJ='MOL1 MOl2 ...'
    MD_TYPE='MD'       # Either MD or GAMD
    MAX_NA_GLOBAL=10   # Maximum number of the closest Na+ ions to be 
                       # considered. Def All Na+ ions.
    PEEL=14            # Thickness of the solvent layer around the
                       # solute atoms. Def 14
    SIEVE=50           # PDB files are extracted every #SIEVE of frames
                       # Def 50 
    SNAPSHOTS_DIR='SNAPSHOTS'   # Name of the subdirectory in which
                                # the PDB are saved. Def SNAPSHOTS
    NPROCS=6           # Number of cores to be used. Def all available.

    The MD_PROD, PREFIX_MDCRD and SUFFIX_MDCRD variables define the
    list of mdcrd trajectory files to be processed. Their def values
    shown below are suitable for trajectories produced using do_runmd.sh

    MD_PROD='5.PRODUCTION'
    PREFIX_MDCRD='md_'
    SUFFIX_MDCRD='_solutewat.mdcrd'

    The list of mdcrd files to be processed is built by the command:

    ls ${MD_PROD}/${PREFIX_MDCRD}???{SUFFIX_MDCRD}

    Note that do_snapshots.sh works in an incremental manner. For example,
    if you run do_snapshots once and subsequently double the extension of 
    the MD trajectories when you run do_snapshots again, it will process
    only the latter trajectory files provided that the SIEVE, PEEL and 
    MAX_NA_GLOBAL options remain unchanged. 

###############################################################################
